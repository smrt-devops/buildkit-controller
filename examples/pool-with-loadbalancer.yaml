# Example BuildKitPool with LoadBalancer service type and Tailscale load balancer class
apiVersion: buildkit.smrt-devops.net/v1alpha1
kind: BuildKitPool
metadata:
  name: buildkit-pool
  namespace: buildkit-system
spec:
  scaling:
    min: 0
    max: 10
    mode: auto
  resources:
    buildkit:
      limits:
        cpu: 2
        memory: 4Gi
      requests:
        cpu: 500m
        memory: 1Gi
  cache:
    backends:
      - type: local
        local:
          storageClass: gp3
          size: 100Gi
  tls:
    enabled: true
    mode: auto
  auth:
    methods:
      - type: mtls
        mtls:
          required: true
  gateway:
    enabled: true
    serviceType: LoadBalancer
    loadBalancerClass: tailscale # Use Tailscale load balancer
    port: 1235
  buildkitImage: moby/buildkit:master-rootless
  gatewayImage: ghcr.io/smrt-devops/buildkit-controller/gateway:latest
