# Development values for buildkit-controller
# Use with: helm install -f values-dev.yaml
image:
  tag: v0.1.4

gateway:
  image:
    tag: v0.1.4

# External ingress configuration
# List of supported ingress types for pools
# Options: ["ingress"], ["gatewayapi"], ["ingress", "gatewayapi"], or [] (internal only)
# Pools can independently choose their ingress type, but it must be in this list
ingress:
  types: ["gatewayapi"] # Support Gateway API (can add "ingress" to support both)

controller:
  replicas: 2
  resources:
    limits:
      cpu: 200m
      memory: 64Mi
    requests:
      cpu: 10m
      memory: 32Mi
  leaderElection:
    enabled: true
  # API GatewayAPI configuration for local development
  # TLS is mandatory when GatewayAPI is enabled
  api:
    enabled: true
    port: 8082
    gatewayAPI:
      enabled: true
      hostname: "api.buildkit.smartdevops.net"
      gatewayRef:
        name: "buildkit-api-gateway" # You must create this Gateway resource separately
        namespace: "" # Same namespace

localOidc:
  enabled: true
  # For Kind clusters, use the docker network gateway IP
  # You can find this with: docker network inspect kind -f '{{range .IPAM.Config}}{{.Gateway}}{{end}}'
  # Common values: 172.18.0.1 (Docker), host.docker.internal (Docker Desktop)
  issuer: "http://mock-oidc.buildkit-system.svc:8888"
  audience: "buildkit-controller"
  claimsMapping:
    user: "actor"
    pools: "repository"
